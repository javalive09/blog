---
title: 命令行
date: 2017-02-10 16:42:45
tags:
---

# linux文件
## 列出目录下文件的权限
```
ls －al
```
## 修改文件权限
权限的字母表示：u-user  g-group  o-others  a-all
权限的数字表示：4-读  2-写  1-执行
```
chmod 777 a.txt
chmod u=rwx, g=rwx, o=rwx a.txt
chmod a=rwx a.txt
```
## 修改文件夹权限
```
chmod -R 777  folder
```

## 查看文件夹的大小
du 命令 disk use
参数含义：
s:sum 
h:human can read
```
du -sh ./sdk
```
## 查看磁盘使用情况
```
du -h
```

## 查找文件
以当前目录为根目录查找名字为DownloadManager.Java的文件所在位置
```
find . -name "DownloadManager.java" 
```
忽略大小写
```
find . -iname "DownloadManager.java" 
```

## 查找字符串
查找某目录下所有包含DownloadManager字符的文件
参数含义：
r:recurisive  递归
n:显示line number
```
grep -rn DownloadManager /Users/peter/Downloads/Android4.4源码
```
## 删除jar包中的文件夹
```
zip --delete baseproject.jar "com/luajava/*"  
```
## 列出历史命令
```
history

history | more
```
## 链接文件
ln -s [source] [target]
```
ln -s /Users/peter/blog/source/post-commit post-commit
```

## 环境变量
### 列出所有的环境变量
```
env
```
### 加入环境变量
```
export PATH=$PATH:[path]
export PATH=$PATH:/Users/peter/Downloads/protoc-3.3.0-osx-x86_64/bin
```
或
```
vim ~/.bashrc
加入export PATH=$PATH:/Users/peter/Downloads/protoc-3.3.0-osx-x86_64/bin
```

## echo
```
echo 'android-8.0.0_r17' >> readme.txt
//>> 是追加内容
//> 是覆盖原有内容
```



------

# adb
## 安装程序
### 重新安装
```
adb install com.xx.xx 
```
### 重新安装，保持原程序数据
```
adb install -r com.xx.xx 
```
### 安装到SD卡中
```
adb install -s com.xx.xx 
```
## 卸载程序
### 完全卸载
```
adb uninstall com.xx.xx
```
### 卸载，保留缓存
```
adb uninstall －k com.xx.xxx
```
## 删除程序缓存
```
shell@android:/data/data/com.example.testandroidid # rm -rf cache  
```
```
shell@android:/data/data/com.example.testandroidid # rm -r cache  
```
## log
### 过滤
#### 字符串xxx
```
adb logcat | grep xxx
```
#### error级
```
adb logcat | grep "^E.123" //tag 123
```
#### warning级
```
adb logcat | grep "^W.123" //tag 123
```
#### 所有
```
adb logcat | grep "^..123" //tag 123
```
### 清除
```
adb logcat -c && adb logcat
```
### 保存到电脑
```
adb logcat > log.txt 
```
### 保存到手机
```
logcat -v threadtime --pid 17393 -f /storage/emulated/0/.peter/logs/codebag/codebag.log -r 20480 -n 3 -s *:I
//官方文档：https://developer.android.com/studio/command-line/logcat.html#filteringOutput
```

## kill app
```
pm force-stop com.xx.xx 
```
## 列出所有安装包
```
pm list package
```

## 修改host
```
//android
adb shell  
su  
vi /etc/hosts

//mac
vi /private/etc/hosts
```


## 打开网页
```
adb shell am start -a android.intent.action.VIEW -d http://www.baidu.com
```

## 打开设置
```
adb shell am start -n com.android.settings/com.android.settings.Settings
```

## 打开入口程序列表
```
adb shell am start -a "android.intent.action.MAIN"  
```

## 获取分辨率
```
adb shell wm size
```

## 设置分辨率
```
adb shell wm size 540x960
```

## 还原分辨率
```
adb shell wm size reset
```

## 获取屏幕密度
```
adb shell wm density  
```

## 设置屏幕密度
```
adb shell wm density 320  
```

## 还原屏幕密度
```
adb shell wm density reset  
```

## “Read-only file system”解决办法
```
adb remount
```

## 查询端口所在进程
```
sudo netstat -tulpn | grep :8000 
```

## kill pid
```
kill -9 <进程 pid>
```
## 查看最大线程数
```
cat /proc/sys/kernel/threads-max  
```
## 查看系统各个限制的数值
```
ulimit -a
```
## 录制gif
android 4.4 以上
### 录制
```
adb shell screenrecord  --bit-rate 2000000 --size 480x800 /sdcard/test.mp4  
```
### 导出
```
adb pull /sdcard/test.mp4 ~/Desktop/test.mp4  
```
## 修改文件所在组
```
sudo chown -R $USER /usr/local 
```
```
sudo chown -R $peter /usr/local
```

## 导出anr文件
anr 数据保存位置：/data/anr/traces.txt  
```
adb pull /data/anr/traces.txt ~/Desktop/    

```

## adb发广播

```
am broadcast -a duershow.settings.ota.findnewversion

adb shell am broadcast -a com.android.test --es test_string "this is test string" --ei test_int 100 --ez test_boolean true
```

## adb 详细命令
```
help
      Print this help text.
  start-activity [-D] [-N] [-W] [-P <FILE>] [--start-profiler <FILE>]
          [--sampling INTERVAL] [--streaming] [-R COUNT] [-S]
          [--track-allocation] [--user <USER_ID> | current] <INTENT>
      Start an Activity.  Options are:
      -D: enable debugging
      -N: enable native debugging
      -W: wait for launch to complete
      --start-profiler <FILE>: start profiler and send results to <FILE>
      --sampling INTERVAL: use sample profiling with INTERVAL microseconds
          between samples (use with --start-profiler)
      --streaming: stream the profiling output to the specified file
          (use with --start-profiler)
      -P <FILE>: like above, but profiling stops when app goes idle
      -R: repeat the activity launch <COUNT> times.  Prior to each repeat,
          the top activity will be finished.
      -S: force stop the target app before starting the activity
      --track-allocation: enable tracking of object allocations
      --user <USER_ID> | current: Specify which user to run as; if not
          specified then run as the current user.
      --stack <STACK_ID>: Specify into which stack should the activity be put.
  start-service [--user <USER_ID> | current] <INTENT>
      Start a Service.  Options are:
      --user <USER_ID> | current: Specify which user to run as; if not
          specified then run as the current user.
  start-foreground-service [--user <USER_ID> | current] <INTENT>
      Start a foreground Service.  Options are:
      --user <USER_ID> | current: Specify which user to run as; if not
          specified then run as the current user.
  stop-service [--user <USER_ID> | current] <INTENT>
      Stop a Service.  Options are:
      --user <USER_ID> | current: Specify which user to run as; if not
          specified then run as the current user.
  broadcast [--user <USER_ID> | all | current] <INTENT>
      Send a broadcast Intent.  Options are:
      --user <USER_ID> | all | current: Specify which user to send to; if not
          specified then send to all users.
      --receiver-permission <PERMISSION>: Require receiver to hold permission.
  instrument [-r] [-e <NAME> <VALUE>] [-p <FILE>] [-w]
          [--user <USER_ID> | current]
          [--no-window-animation] [--abi <ABI>] <COMPONENT>
      Start an Instrumentation.  Typically this target <COMPONENT> is in the
      form <TEST_PACKAGE>/<RUNNER_CLASS> or only <TEST_PACKAGE> if there
      is only one instrumentation.  Options are:
      -r: print raw results (otherwise decode REPORT_KEY_STREAMRESULT).  Use with
          [-e perf true] to generate raw output for performance measurements.
      -e <NAME> <VALUE>: set argument <NAME> to <VALUE>.  For test runners a
          common form is [-e <testrunner_flag> <value>[,<value>...]].
      -p <FILE>: write profiling data to <FILE>
      -m: Write output as protobuf (machine readable)
      -w: wait for instrumentation to finish before returning.  Required for
          test runners.
      --user <USER_ID> | current: Specify user instrumentation runs in;
          current user if not specified.
      --no-window-animation: turn off window animations while running.
      --abi <ABI>: Launch the instrumented process with the selected ABI.
          This assumes that the process supports the selected ABI.
  trace-ipc [start|stop] [--dump-file <FILE>]
      Trace IPC transactions.
      start: start tracing IPC transactions.
      stop: stop tracing IPC transactions and dump the results to file.
      --dump-file <FILE>: Specify the file the trace should be dumped to.
  profile [start|stop] [--user <USER_ID> current] [--sampling INTERVAL]
          [--streaming] <PROCESS> <FILE>
      Start and stop profiler on a process.  The given <PROCESS> argument
        may be either a process name or pid.  Options are:
      --user <USER_ID> | current: When supplying a process name,
          specify user of process to profile; uses current user if not specified.
      --sampling INTERVAL: use sample profiling with INTERVAL microseconds
          between samples
      --streaming: stream the profiling output to the specified file
  dumpheap [--user <USER_ID> current] [-n] <PROCESS> <FILE>
      Dump the heap of a process.  The given <PROCESS> argument may
        be either a process name or pid.  Options are:
      -n: dump native heap instead of managed heap
      --user <USER_ID> | current: When supplying a process name,
          specify user of process to dump; uses current user if not specified.
  set-debug-app [-w] [--persistent] <PACKAGE>
      Set application <PACKAGE> to debug.  Options are:
      -w: wait for debugger when application starts
      --persistent: retain this value
  clear-debug-app
      Clear the previously set-debug-app.
  set-watch-heap <PROCESS> <MEM-LIMIT>
      Start monitoring pss size of <PROCESS>, if it is at or
      above <HEAP-LIMIT> then a heap dump is collected for the user to report.
  clear-watch-heap
      Clear the previously set-watch-heap.
  bug-report [--progress | --telephony]
      Request bug report generation; will launch a notification
        when done to select where it should be delivered. Options are:
     --progress: will launch a notification right away to show its progress.
     --telephony: will dump only telephony sections.
  force-stop [--user <USER_ID> | all | current] <PACKAGE>
      Completely stop the given application package.
  crash [--user <USER_ID>] <PACKAGE|PID>
      Induce a VM crash in the specified package or process
  kill [--user <USER_ID> | all | current] <PACKAGE>
      Kill all processes associated with the given application.
  kill-all
      Kill all processes that are safe to kill (cached, etc).
  make-uid-idle [--user <USER_ID> | all | current] <PACKAGE>
      If the given application's uid is in the background and waiting to
      become idle (not allowing background services), do that now.
  monitor [--gdb <port>]
      Start monitoring for crashes or ANRs.
      --gdb: start gdbserv on the given port at crash/ANR
  hang [--allow-restart]
      Hang the system.
      --allow-restart: allow watchdog to perform normal system restart
  restart
      Restart the user-space system.
  idle-maintenance
      Perform idle maintenance now.
  screen-compat [on|off] <PACKAGE>
      Control screen compatibility mode of <PACKAGE>.
  package-importance <PACKAGE>
      Print current importance of <PACKAGE>.
  to-uri [INTENT]
      Print the given Intent specification as a URI.
  to-intent-uri [INTENT]
      Print the given Intent specification as an intent: URI.
  to-app-uri [INTENT]
      Print the given Intent specification as an android-app: URI.
  switch-user <USER_ID>
      Switch to put USER_ID in the foreground, starting
      execution of that user if it is currently stopped.
  get-current-user
      Returns id of the current foreground user.
  start-user <USER_ID>
      Start USER_ID in background if it is currently stopped;
      use switch-user if you want to start the user in foreground
  unlock-user <USER_ID> [TOKEN_HEX]
      Attempt to unlock the given user using the given authorization token.
  stop-user [-w] [-f] <USER_ID>
      Stop execution of USER_ID, not allowing it to run any
      code until a later explicit start or switch to it.
      -w: wait for stop-user to complete.
      -f: force stop even if there are related users that cannot be stopped.
  is-user-stopped <USER_ID>
      Returns whether <USER_ID> has been stopped or not.
  get-started-user-state <USER_ID>
      Gets the current state of the given started user.
  track-associations
      Enable association tracking.
  untrack-associations
      Disable and clear association tracking.
  get-uid-state <UID>
      Gets the process state of an app given its <UID>.
  attach-agent <PROCESS> <FILE>
    Attach an agent to the specified <PROCESS>, which may be either a process name or a PID.
  get-config
      Rtrieve the configuration and any recent configurations of the device.
  supports-multiwindow
      Returns true if the device supports multiwindow.
  supports-split-screen-multi-window
      Returns true if the device supports split screen multiwindow.
  suppress-resize-config-changes <true|false>
      Suppresses configuration changes due to user resizing an activity/task.
  set-inactive [--user <USER_ID>] <PACKAGE> true|false
      Sets the inactive state of an app.
  get-inactive [--user <USER_ID>] <PACKAGE>
      Returns the inactive state of an app.
  send-trim-memory [--user <USER_ID>] <PROCESS>
          [HIDDEN|RUNNING_MODERATE|BACKGROUND|RUNNING_LOW|MODERATE|RUNNING_CRITICAL|COMPLETE]
      Send a memory trim event to a <PROCESS>.
  display [COMMAND] [...]: sub-commands for operating on displays.
       move-stack <STACK_ID> <DISPLAY_ID>
           Move <STACK_ID> from its current display to <DISPLAY_ID>.
  stack [COMMAND] [...]: sub-commands for operating on activity stacks.
       start <DISPLAY_ID> <INTENT>
           Start a new activity on <DISPLAY_ID> using <INTENT>
       move-task <TASK_ID> <STACK_ID> [true|false]
           Move <TASK_ID> from its current stack to the top (true) or
           bottom (false) of <STACK_ID>.
       resize <STACK_ID> <LEFT,TOP,RIGHT,BOTTOM>
           Change <STACK_ID> size and position to <LEFT,TOP,RIGHT,BOTTOM>.
       resize-animated <STACK_ID> <LEFT,TOP,RIGHT,BOTTOM>
           Same as resize, but allow animation.
       resize-docked-stack <LEFT,TOP,RIGHT,BOTTOM> [<TASK_LEFT,TASK_TOP,TASK_RIGHT,TASK_BOTTOM>]
           Change docked stack to <LEFT,TOP,RIGHT,BOTTOM>
           and supplying temporary different task bounds indicated by
           <TASK_LEFT,TOP,RIGHT,BOTTOM>
       size-docked-stack-test: <STEP_SIZE> <l|t|r|b> [DELAY_MS]
           Test command for sizing docked stack by
           <STEP_SIZE> increments from the side <l>eft, <t>op, <r>ight, or <b>ottom
           applying the optional [DELAY_MS] between each step.
       move-top-activity-to-pinned-stack: <STACK_ID> <LEFT,TOP,RIGHT,BOTTOM>
           Moves the top activity from
           <STACK_ID> to the pinned stack using <LEFT,TOP,RIGHT,BOTTOM> for the
           bounds of the pinned stack.
       positiontask <TASK_ID> <STACK_ID> <POSITION>
           Place <TASK_ID> in <STACK_ID> at <POSITION>
       list
           List all of the activity stacks and their sizes.
       info <STACK_ID>
           Display the information about activity stack <STACK_ID>.
       remove <STACK_ID>
           Remove stack <STACK_ID>.
  task [COMMAND] [...]: sub-commands for operating on activity tasks.
       lock <TASK_ID>
           Bring <TASK_ID> to the front and don't allow other tasks to run.
       lock stop
           End the current task lock.
       resizeable <TASK_ID> [0|1|2|3]
           Change resizeable mode of <TASK_ID> to one of the following:
           0: unresizeable
           1: crop_windows
           2: resizeable
           3: resizeable_and_pipable
       resize <TASK_ID> <LEFT,TOP,RIGHT,BOTTOM>
           Makes sure <TASK_ID> is in a stack with the specified bounds.
           Forces the task to be resizeable and creates a stack if no existing stack
           has the specified bounds.
       drag-task-test <TASK_ID> <STEP_SIZE> [DELAY_MS]
           Test command for dragging/moving <TASK_ID> by
           <STEP_SIZE> increments around the screen applying the optional [DELAY_MS]
           between each step.
       size-task-test <TASK_ID> <STEP_SIZE> [DELAY_MS]
           Test command for sizing <TASK_ID> by <STEP_SIZE>
           increments within the screen applying the optional [DELAY_MS] between
           each step.
  update-appinfo <USER_ID> <PACKAGE_NAME> [<PACKAGE_NAME>...]
      Update the ApplicationInfo objects of the listed packages for <USER_ID>
      without restarting any processes.
  write
      Write all pending state to storage.

<INTENT> specifications include these flags and arguments:
    [-a <ACTION>] [-d <DATA_URI>] [-t <MIME_TYPE>]
    [-c <CATEGORY> [-c <CATEGORY>] ...]
    [-e|--es <EXTRA_KEY> <EXTRA_STRING_VALUE> ...]
    [--esn <EXTRA_KEY> ...]
    [--ez <EXTRA_KEY> <EXTRA_BOOLEAN_VALUE> ...]
    [--ei <EXTRA_KEY> <EXTRA_INT_VALUE> ...]
    [--el <EXTRA_KEY> <EXTRA_LONG_VALUE> ...]
    [--ef <EXTRA_KEY> <EXTRA_FLOAT_VALUE> ...]
    [--eu <EXTRA_KEY> <EXTRA_URI_VALUE> ...]
    [--ecn <EXTRA_KEY> <EXTRA_COMPONENT_NAME_VALUE>]
    [--eia <EXTRA_KEY> <EXTRA_INT_VALUE>[,<EXTRA_INT_VALUE...]]
        (mutiple extras passed as Integer[])
    [--eial <EXTRA_KEY> <EXTRA_INT_VALUE>[,<EXTRA_INT_VALUE...]]
        (mutiple extras passed as List<Integer>)
    [--ela <EXTRA_KEY> <EXTRA_LONG_VALUE>[,<EXTRA_LONG_VALUE...]]
        (mutiple extras passed as Long[])
    [--elal <EXTRA_KEY> <EXTRA_LONG_VALUE>[,<EXTRA_LONG_VALUE...]]
        (mutiple extras passed as List<Long>)
    [--efa <EXTRA_KEY> <EXTRA_FLOAT_VALUE>[,<EXTRA_FLOAT_VALUE...]]
        (mutiple extras passed as Float[])
    [--efal <EXTRA_KEY> <EXTRA_FLOAT_VALUE>[,<EXTRA_FLOAT_VALUE...]]
        (mutiple extras passed as List<Float>)
    [--esa <EXTRA_KEY> <EXTRA_STRING_VALUE>[,<EXTRA_STRING_VALUE...]]
        (mutiple extras passed as String[]; to embed a comma into a string,
         escape it using "\,")
    [--esal <EXTRA_KEY> <EXTRA_STRING_VALUE>[,<EXTRA_STRING_VALUE...]]
        (mutiple extras passed as List<String>; to embed a comma into a string,
         escape it using "\,")
    [-f <FLAG>]
    [--grant-read-uri-permission] [--grant-write-uri-permission]
    [--grant-persistable-uri-permission] [--grant-prefix-uri-permission]
    [--debug-log-resolution] [--exclude-stopped-packages]
    [--include-stopped-packages]
    [--activity-brought-to-front] [--activity-clear-top]
    [--activity-clear-when-task-reset] [--activity-exclude-from-recents]
    [--activity-launched-from-history] [--activity-multiple-task]
    [--activity-no-animation] [--activity-no-history]
    [--activity-no-user-action] [--activity-previous-is-top]
    [--activity-reorder-to-front] [--activity-reset-task-if-needed]
    [--activity-single-top] [--activity-clear-task]
    [--activity-task-on-home]
    [--receiver-registered-only] [--receiver-replace-pending]
    [--receiver-foreground] [--receiver-no-abort]
    [--receiver-include-background]
    [--selector]
    [<URI> | <PACKAGE> | <COMPONENT>]
```


------

## debug

### 启动时等待调试
set-debug-app 设置调试
-w: wait

```
adb shell am set-debug-app -w com.peter.util.searcher
```

### 持续调试
--persistent: 每次启动都调试

```
adb shell am set-debug-app -w --persistent com.peter.util.searcher
```
### 清除持续调试
```
adb shell am clear-debug-app
```


# python
## 开一个简单的服务器
### python 2.x
```
python -m SimpleHTTPServer [port]
```
### python 3.x
```
python -m http.server [port]
```

------

# 内存

## top命令

```
top -h //help
top -m num //显示的最多进程数
top -s col //Column to sort by (cpu,vss,rss,thr)
top -m 10 -s cpu //ddd
```

------

# 网络
## ping网速
-c count
在收发指定的count个数目的报文后停止
-f
尽可能快地发送报文
-s packetsize
设置要发送的报文大小(单位为字节，最大长度是64k，缺省长度是64)
-i wait
设置连续报文发送时报文间的发送时间间隔（单位为秒）
```
ping -c 5 -s 1024 -i 2 www.baidu.com  
```
发送 5次   1024 byte 间隔 2秒 到百度服务器。

------

# gcc

## 编译单个源文件
gcc xxx.c -o xxx
```
gcc test.c -o test
```
执行./xxx 可运行

## 编译多个源文件
* gcc -c xxx.c 分别编译源文件为xxx.o
* gcc xxx.o yyy.o -o main

```
gcc -c hotel.c
```
```
gcc main.o hotel.o -o main
```
执行./main可运行






